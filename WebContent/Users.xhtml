<!--
Copyright 2013 Imperial College London

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets" xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://jboss.org/schema/seam/taglib" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:rich="http://richfaces.org/rich" template="layout/home_template.xhtml">  
  <ui:define name="body"> 
    <rich:panel> 
      <f:facet name="header">User account details</f:facet>  
      <s:decorate id="firstName" template="layout/display.xhtml"> 
        <ui:define name="label">First name</ui:define>  
        <h:outputText value="#{usersHome.instance.firstName}"></h:outputText> 
      </s:decorate>  
      <s:decorate id="lastName" template="layout/display.xhtml"> 
        <ui:define name="label">Last name</ui:define>  
        <h:outputText value="#{usersHome.instance.lastName}"></h:outputText> 
      </s:decorate>  
      <s:decorate id="registrationDate" template="layout/display.xhtml"> 
        <ui:define name="label">Registration date</ui:define>  
        <h:outputText value="#{usersHome.instance.registrationDate}"> 
          <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
        </h:outputText> 
      </s:decorate>  
      <s:decorate id="active" template="layout/display.xhtml"> 
        <ui:define name="label">Active</ui:define>  
        <h:outputText value="#{usersHome.instance.active}"></h:outputText> 
      </s:decorate>  
      <s:decorate id="loginName" template="layout/display.xhtml"> 
        <ui:define name="label">Login name</ui:define>  
        <h:outputText value="#{usersHome.instance.loginName}"></h:outputText> 
      </s:decorate>  
      <s:decorate id="password" template="layout/display.xhtml" rendered="false"> 
        <ui:define name="label">Password</ui:define>  
        <h:outputText value="#{usersHome.instance.password}"></h:outputText> 
      </s:decorate>  
      <s:decorate id="email" template="layout/display.xhtml"> 
        <ui:define name="label">Email</ui:define>  
        <h:outputText value="#{usersHome.instance.email}"></h:outputText> 
      </s:decorate>  
      <div style="clear:both"></div> 
    </rich:panel>  
    <div class="actionButtons"> 
      <s:button view="/UsersEdit.xhtml" id="edit" value="Edit" disabled="#{(usersHome.instance.id != identity.id) and not identity.hasRole(roleIDs.PROJECT_ADMIN_id)}"></s:button>  
      <s:button view="/#{empty usersFrom ? 'UsersList' : usersFrom}.xhtml" id="done" value="Done" action="#{bijectionUtility.clearInstances('usersHome')}"></s:button> 
    </div>  
    <rich:tabPanel switchType="client"> 
      <rich:tab> 
        <f:facet name="header"> 
          <h:panelGroup> 
            <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>Project Roles
          </h:panelGroup> 
        </f:facet>  
        <h:form styleClass="association" id="userProjectRolesesChildren"> 
          <h:outputText value="There are no Project Roles associated with this user." rendered="#{empty usersHome.userProjectRoleses}"></h:outputText>  
          <rich:dataTable value="#{usersHome.userProjectRoleses}" var="_userProjectRoles" rendered="#{not empty usersHome.userProjectRoleses}" rowClasses="rvgRowOne,rvgRowTwo" id="userProjectRolesesTable" rows="10"> 
            <rich:column sortBy="#{_userProjectRoles.users.loginName}"> 
              <f:facet name="header">User</f:facet>  
              <h:outputText value="#{_userProjectRoles.users.loginName}"></h:outputText> 
            </rich:column>  
            <rich:column sortBy="#{_userProjectRoles.projects.shortName}"> 
              <f:facet name="header">Project</f:facet>  
              <h:outputText value="#{_userProjectRoles.projects.shortName}"></h:outputText> 
            </rich:column>  
            <rich:column sortBy="#{_userProjectRoles.roles.name}"> 
              <f:facet name="header">Role</f:facet>  
              <h:outputText value="#{_userProjectRoles.roles.name}"></h:outputText> 
            </rich:column>  
            <h:column> 
              <f:facet name="header">Action</f:facet>  
              <s:link id="selectuserProjectRoles" value="Select" view="/UserProjectRoles.xhtml" disabled="#{(_userProjectRoles.roles.id le identity.topRoleId) or (_userProjectRoles.roles.id == roleIDs.PROGRAMME_EVALUATOR_id and identity.topRoleId == roleIDs.PROJECT_ADMIN_id) or not identity.hasRole(roleIDs.PROJECT_ADMIN_id)}"> 
                <f:param name="userProjectRolesUserId" value="#{_userProjectRoles.id.userId}"></f:param>  
                <f:param name="userProjectRolesProjectId" value="#{_userProjectRoles.id.projectId}"></f:param>  
                <f:param name="userProjectRolesFrom" value="Users"></f:param> 
              </s:link> 
            </h:column> 
          </rich:dataTable>  
          <rich:dataScroller for="userProjectRolesesTable" renderIfSinglePage="false"></rich:dataScroller> 
        </h:form> 
      </rich:tab> 
    </rich:tabPanel>  
    <rich:collapsiblePanel headerClass="collapsiblePanelHeader" switchType="client" expanded="false" style="width:944px; overflow: auto;"> 
      <f:facet name="headerCollapsed">User's entries (click to expand)</f:facet>  
      <f:facet name="headerExpanded">User's entries (click to collapse)</f:facet>  
      <rich:tabPanel id="userEntriesTabPanelId" switchType="client" rendered="#{usersHome.anyActivities()}" style="width:924px; overflow: auto;"> 
        <rich:tab rendered="#{not empty usersHome.userMessageses and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id))}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>User messages
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="userMessagesesChildren"> 
            <h:outputText value="There are no user messages associated with this user." rendered="#{empty usersHome.userMessageses}"></h:outputText>  
            <rich:dataTable value="#{usersHome.userMessageses}" var="_userMessages" rendered="#{not empty usersHome.userMessageses}" rowClasses="rvgRowOne,rvgRowTwo" id="userMessagesesTable" rows="10"> 
              <rich:column sortBy="#{_userMessages.users.loginName}"> 
                <f:facet name="header">User</f:facet>  
                <h:outputText value="#{_userMessages.users.loginName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userMessages.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_userMessages.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userMessages.id.rcTimestamp}"> 
                <f:facet name="header">Date Entry Made</f:facet>  
                <h:outputText value="#{_userMessages.id.rcTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userMessages.message}"> 
                <f:facet name="header">Message</f:facet>  
                <h:outputText value="#{_userMessages.message}"></h:outputText> 
              </rich:column>  
              <h:column rendered="false"> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectuserMessages" value="Select" view="/UserMessages.xhtml"> 
                  <f:param name="userMessagesUserId" value="#{_userMessages.id.userId}"></f:param>  
                  <f:param name="userMessagesProjectId" value="#{_userMessages.id.projectId}"></f:param>  
                  <f:param name="userMessagesRcTimestamp" value="#{_userMessages.id.rcTimestamp}"></f:param>  
                  <f:param name="userMessagesFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="userMessagesesTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add user message" view="/UserMessagesEdit.xhtml" disabled="true"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="userMessagesFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.loginAudits and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.WRT_ADMIN_id))}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>User logins
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="loginAuditsChildren"> 
            <h:outputText value="There are no user login records associated with this user." rendered="#{empty usersHome.loginAudits}"></h:outputText>  
            <rich:dataTable value="#{usersHome.loginAudits}" var="_loginAudit" rendered="#{not empty usersHome.loginAudits}" rowClasses="rvgRowOne,rvgRowTwo" id="loginAuditsTable" rows="10"> 
              <rich:column sortBy="#{_loginAudit.users.loginName}"> 
                <f:facet name="header">User</f:facet>  
                <h:outputText value="#{_loginAudit.users.loginName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_loginAudit.id.sessionId}"> 
                <f:facet name="header">Session id</f:facet>  
                <h:outputText value="#{_loginAudit.id.sessionId}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_loginAudit.id.ipAddress}"> 
                <f:facet name="header">Ip address</f:facet>  
                <h:outputText value="#{_loginAudit.id.ipAddress}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_loginAudit.id.loggedInDateTime}"> 
                <f:facet name="header">Logged in date time</f:facet>  
                <h:outputText value="#{_loginAudit.id.loggedInDateTime}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_loginAudit.loggedOutDateTime}"> 
                <f:facet name="header">Logged out date time</f:facet>  
                <h:outputText value="#{_loginAudit.loggedOutDateTime}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_loginAudit.sessionExpiredDateTime}"> 
                <f:facet name="header">Session expired date time</f:facet>  
                <h:outputText value="#{_loginAudit.sessionExpiredDateTime}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectloginAudit" value="Select" view="/LoginAudit.xhtml" disabled="#{not identity.hasRole(roleIDs.WRT_ADMIN_id)}"> 
                  <f:param name="loginAuditUserId" value="#{_loginAudit.id.userId}"></f:param>  
                  <f:param name="loginAuditSessionId" value="#{_loginAudit.id.sessionId}"></f:param>  
                  <f:param name="loginAuditIpAddress" value="#{_loginAudit.id.ipAddress}"></f:param>  
                  <f:param name="loginAuditLoggedInDateTime" value="#{_loginAudit.id.loggedInDateTime}"></f:param>  
                  <f:param name="loginAuditFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="loginAuditsTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add loginAudit" view="/LoginAuditEdit.xhtml" disabled="true"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="loginAuditFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.sustainabilities and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id)) and not suspendedModules.isSuspended( 'sustainability' )}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>Sustainability scores
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="sustainabilitiesChildren"> 
            <h:outputText value="There are no Sustainability records associated with this user." rendered="#{empty usersHome.sustainabilities}"></h:outputText>  
            <rich:dataTable value="#{usersHome.sustainabilities}" var="_sustainability" rendered="#{not empty usersHome.sustainabilities}" rowClasses="rvgRowOne,rvgRowTwo" id="sustainabilitiesTable" rows="10"> 
              <rich:column sortBy="#{_sustainability.id}"> 
                <f:facet name="header">Entry ID</f:facet>  
                <h:outputText value="#{_sustainability.id}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_sustainability.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.eventDate}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Event date</f:facet>  
                <h:outputText value="#{_sustainability.eventDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score1Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score1</f:facet>  
                <h:outputText value="#{_sustainability.score1Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score2Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score2</f:facet>  
                <h:outputText value="#{_sustainability.score2Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score3Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score3</f:facet>  
                <h:outputText value="#{_sustainability.score3Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score4Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score4</f:facet>  
                <h:outputText value="#{_sustainability.score4Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score5Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score5</f:facet>  
                <h:outputText value="#{_sustainability.score5Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score6Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score6</f:facet>  
                <h:outputText value="#{_sustainability.score6Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score7Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score7</f:facet>  
                <h:outputText value="#{_sustainability.score7Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score8Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score8</f:facet>  
                <h:outputText value="#{_sustainability.score8Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score9Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score9</f:facet>  
                <h:outputText value="#{_sustainability.score9Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.score10Val()}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Score10</f:facet>  
                <h:outputText value="#{_sustainability.score10Val()}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.comment}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Comment</f:facet>  
                <h:outputText value="#{_sustainability.comment}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_sustainability.rcTimestamp}"> 
                <f:facet name="header">Date Entry Made</f:facet>  
                <h:outputText value="#{_sustainability.rcTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectsustainability" value="Select" view="/Sustainability.xhtml" action="#{activeProjectHome.wire(_sustainability.projects.id)}" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_sustainability.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="sustainabilityId" value="#{_sustainability.id}"></f:param>  
                  <f:param name="sustainabilityFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="sustainabilitiesTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add Sustainability score" view="/SustainabilityEdit.xhtml" disabled="#{identity.id != usersHome.instance.id}"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="sustainabilityFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.pdsas and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id)) and not suspendedModules.isSuspended( 'pdsa' )}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>PDSA cycles
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="pdsasChildren"> 
            <h:outputText value="There are no PDSA records associated with this user." rendered="#{empty usersHome.pdsas}"></h:outputText>  
            <rich:dataTable value="#{usersHome.pdsas}" var="_pdsa" rendered="#{not empty usersHome.pdsas}" rowClasses="rvgRowOne,rvgRowTwo" id="pdsasTable" rows="10"> 
              <rich:column sortBy="#{_pdsa.id}"> 
                <f:facet name="header">Entry ID</f:facet>  
                <h:outputText value="#{_pdsa.id}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_pdsa.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.eventDate}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Event date</f:facet>  
                <h:outputText value="#{_pdsa.eventDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.description}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Description</f:facet>  
                <h:outputText value="#{_pdsa.description}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.doDescription}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Do description</f:facet>  
                <h:outputText value="#{_pdsa.doDescription}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.studyDescription}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Study description</f:facet>  
                <h:outputText value="#{_pdsa.studyDescription}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.actDescription}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Act description</f:facet>  
                <h:outputText value="#{_pdsa.actDescription}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.planTeam}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Plan team</f:facet>  
                <h:outputText value="#{_pdsa.planTeam}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.studyTeam}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Study team</f:facet>  
                <h:outputText value="#{_pdsa.studyTeam}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.doTeam}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Do team</f:facet>  
                <h:outputText value="#{_pdsa.doTeam}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.actTeam}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Act team</f:facet>  
                <h:outputText value="#{_pdsa.actTeam}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.doDate}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Do date</f:facet>  
                <h:outputText value="#{_pdsa.doDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.studyDate}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Study date</f:facet>  
                <h:outputText value="#{_pdsa.studyDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.actDate}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Act date</f:facet>  
                <h:outputText value="#{_pdsa.actDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.cycleTitle}"> 
                <f:facet name="header">Cycle title</f:facet>  
                <h:outputText value="#{_pdsa.cycleTitle}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_pdsa.rcTimestamp}"> 
                <f:facet name="header">Date Entry Made</f:facet>  
                <h:outputText value="#{_pdsa.rcTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectpdsa" value="Select" view="/Pdsa.xhtml" action="#{activeProjectHome.wire(_pdsa.projects.id)}" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_pdsa.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="pdsaId" value="#{_pdsa.id}"></f:param>  
                  <f:param name="pdsaFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="pdsasTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add PDSA cycle" view="/PdsaEdit.xhtml" disabled="#{identity.id != usersHome.instance.id}"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="pdsaFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.ppis and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id)) and not suspendedModules.isSuspended( 'ppi' )}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>PPI scores
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="ppisChildren"> 
            <h:outputText value="There are no PPI records associated with this user." rendered="#{empty usersHome.ppis}"></h:outputText>  
            <rich:dataTable value="#{usersHome.ppis}" var="_ppi" rendered="#{not empty usersHome.ppis}" rowClasses="rvgRowOne,rvgRowTwo" id="ppisTable" rows="10"> 
              <rich:column sortBy="#{_ppi.id}"> 
                <f:facet name="header">Entry ID</f:facet>  
                <h:outputText value="#{_ppi.id}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_ppi.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.entryDate}"> 
                <f:facet name="header">Entry date</f:facet>  
                <h:outputText value="#{_ppi.entryDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.role}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Role</f:facet>  
                <h:outputText value="#{_ppi.role}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.receptive}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Receptive</f:facet>  
                <h:outputText value="#{_ppi.receptiveVal}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.difference}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Difference</f:facet>  
                <h:outputText value="#{_ppi.differenceVal}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.plans}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Plans</f:facet>  
                <h:outputText value="#{_ppi.plansVal}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.comments}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Comments</f:facet>  
                <h:outputText value="#{_ppi.comments}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_ppi.rcTimestamp}"> 
                <f:facet name="header">Date Entry Made</f:facet>  
                <h:outputText value="#{_ppi.rcTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectppi" value="Select" view="/Ppi.xhtml" action="#{activeProjectHome.wire(_ppi.projects.id)}" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_ppi.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="ppiId" value="#{_ppi.id}"></f:param>  
                  <f:param name="ppiFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="ppisTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add PPI score" view="/PpiEdit.xhtml" disabled="#{identity.id != usersHome.instance.id}"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="ppiFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.comments and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id))}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>Comments
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="commentsChildren"> 
            <h:outputText value="There are no comments associated with this user." rendered="#{empty usersHome.comments}"></h:outputText>  
            <rich:dataTable value="#{usersHome.comments}" var="_comment" rendered="#{not empty usersHome.comments}" rowClasses="rvgRowOne,rvgRowTwo" id="commentsTable" rows="10"> 
              <rich:column sortBy="#{_comment.id}"> 
                <f:facet name="header">Entry ID</f:facet>  
                <h:outputText value="#{_comment.id}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_comment.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_comment.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_comment.eventDate}"> 
                <f:facet name="header">Event date</f:facet>  
                <h:outputText value="#{_comment.eventDate}"> 
                  <f:convertDateTime type="date" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_comment.comment}"> 
                <f:facet name="header">Comment</f:facet>  
                <h:outputText value="#{_comment.comment}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_comment.rcTimestamp}"> 
                <f:facet name="header">Date Entry Made</f:facet>  
                <h:outputText value="#{_comment.rcTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectcomment" value="Select" view="/Comment.xhtml" action="#{activeProjectHome.wire(_comment.projects.id)}" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_comment.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="commentId" value="#{_comment.id}"></f:param>  
                  <f:param name="commentFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="commentsTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add comment" view="/CommentEdit.xhtml" disabled="#{identity.id != usersHome.instance.id}"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="commentFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.userProjectRoleRequestses and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id))}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>Project role requests
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="userProjectRoleRequestsesChildren"> 
            <h:outputText value="There are no userProjectRoleRequestses associated with this users." rendered="#{empty usersHome.userProjectRoleRequestses}"></h:outputText>  
            <rich:dataTable value="#{usersHome.userProjectRoleRequestses}" var="_userProjectRoleRequests" rendered="#{not empty usersHome.userProjectRoleRequestses}" rowClasses="rvgRowOne,rvgRowTwo" id="userProjectRoleRequestsesTable" rows="10"> 
              <rich:column sortBy="#{_userProjectRoleRequests.users.loginName}"> 
                <f:facet name="header">User</f:facet>  
                <h:outputText value="#{_userProjectRoleRequests.users.loginName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRoleRequests.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_userProjectRoleRequests.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRoleRequests.roles.name}"> 
                <f:facet name="header">Role</f:facet>  
                <h:outputText value="#{_userProjectRoleRequests.roles.name}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRoleRequests.rcTimestamp}"> 
                <f:facet name="header">Date Request Made</f:facet>  
                <h:outputText value="#{_userProjectRoleRequests.rcTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectuserProjectRoleRequests" value="Select" view="/UserProjectRoleRequests.xhtml" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_userProjectRoleRequests.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="userProjectRoleRequestsUserId" value="#{_userProjectRoleRequests.id.userId}"></f:param>  
                  <f:param name="userProjectRoleRequestsProjectId" value="#{_userProjectRoleRequests.id.projectId}"></f:param>  
                  <f:param name="userProjectRoleRequestsFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="userProjectRoleRequestsesTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Request Project Role" view="/UserProjectRoleRequestsCreate.xhtml" disabled="#{identity.id != usersHome.instance.id}"> 
              <f:param name="userProjectRoleRequestsUserId" value="#{identity.id}"></f:param>  
              <f:param name="userProjectRoleRequestsProjectId"></f:param>  
              <f:param name="usersId" value="#{identity.id}"></f:param>  
              <f:param name="rolesId" value="#{roleIDs.PROJECT_VIEWER_id}"></f:param>  
              <f:param name="userProjectRoleRequestsFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.userProjectRolesAuditsForUserId and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id))}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>Project role audits as user
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="userProjectRolesAuditsForUserIdChildren"> 
            <h:outputText value="There are no userProjectRolesAuditsForUserId associated with this users." rendered="#{empty usersHome.userProjectRolesAuditsForUserId}"></h:outputText>  
            <rich:dataTable value="#{usersHome.userProjectRolesAuditsForUserId}" var="_userProjectRolesAudit" rendered="#{not empty usersHome.userProjectRolesAuditsForUserId}" rowClasses="rvgRowOne,rvgRowTwo" id="userProjectRolesAuditsForUserIdTable" rows="10"> 
              <rich:column sortBy="#{_userProjectRolesAudit.id}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Id</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.id}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.usersByUserId.loginName}"> 
                <f:facet name="header">User</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.usersByUserId.loginName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.roles.name}"> 
                <f:facet name="header">Role</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.roles.name}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.reqTimestamp}"> 
                <f:facet name="header">Date Request Made</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.reqTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.action}"> 
                <f:facet name="header">Action</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.action}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.resTimestamp}"> 
                <f:facet name="header">Date Action Done</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.resTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.usersByAdminId.loginName}"> 
                <f:facet name="header">Admin</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.usersByAdminId.loginName}"></h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectuserProjectRolesAudit" value="Select" view="/UserProjectRolesAudit.xhtml" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_userProjectRolesAudit.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="userProjectRolesAuditId" value="#{_userProjectRolesAudit.id}"></f:param>  
                  <f:param name="userProjectRolesAuditFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="userProjectRolesAuditsForUserIdTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add userProjectRolesAudit" view="/UserProjectRolesAuditEdit.xhtml" disabled="true"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="userProjectRolesAuditFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>  
        <rich:tab rendered="#{not empty usersHome.userProjectRolesAuditsForAdminId and ((identity.id == usersHome.instance.id) or identity.hasRole(roleIDs.PROJECT_ADMIN_id))}"> 
          <f:facet name="header"> 
            <h:panelGroup> 
              <h:graphicImage value="/img/onetomany.gif" style="vertical-align: middle; padding-right: 4px;"></h:graphicImage>Project role audits as admin
            </h:panelGroup> 
          </f:facet>  
          <h:form styleClass="association" id="userProjectRolesAuditsForAdminIdChildren"> 
            <h:outputText value="There are no userProjectRolesAuditsForAdminId associated with this users." rendered="#{empty usersHome.userProjectRolesAuditsForAdminId}"></h:outputText>  
            <rich:dataTable value="#{usersHome.userProjectRolesAuditsForAdminId}" var="_userProjectRolesAudit" rendered="#{not empty usersHome.userProjectRolesAuditsForAdminId}" rowClasses="rvgRowOne,rvgRowTwo" id="userProjectRolesAuditsForAdminIdTable" rows="10"> 
              <rich:column sortBy="#{_userProjectRolesAudit.id}" rendered="#{identity.hasRole(roleIDs.SUPER_ADMIN_id)}"> 
                <f:facet name="header">Id</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.id}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.usersByUserId.loginName}"> 
                <f:facet name="header">User</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.usersByUserId.loginName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.projects.shortName}"> 
                <f:facet name="header">Project</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.projects.shortName}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.roles.name}"> 
                <f:facet name="header">Role</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.roles.name}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.reqTimestamp}"> 
                <f:facet name="header">Date Request Made</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.reqTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.action}"> 
                <f:facet name="header">Action</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.action}"></h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.resTimestamp}"> 
                <f:facet name="header">Date Action Done</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.resTimestamp}"> 
                  <f:convertDateTime type="both" dateStyle="short"></f:convertDateTime> 
                </h:outputText> 
              </rich:column>  
              <rich:column sortBy="#{_userProjectRolesAudit.usersByAdminId.loginName}"> 
                <f:facet name="header">Admin</f:facet>  
                <h:outputText value="#{_userProjectRolesAudit.usersByAdminId.loginName}"></h:outputText> 
              </rich:column>  
              <h:column> 
                <f:facet name="header">Action</f:facet>  
                <s:link id="selectuserProjectRolesAudit" value="Select" view="/UserProjectRolesAudit.xhtml" disabled="#{(identity.id != usersHome.instance.id) and not identity.hasPermission(_userProjectRolesAudit.projects.id,rolesIDs.PROJECT_ADMIN_id,'')}"> 
                  <f:param name="userProjectRolesAuditId" value="#{_userProjectRolesAudit.id}"></f:param>  
                  <f:param name="userProjectRolesAuditFrom" value="Users"></f:param> 
                </s:link> 
              </h:column> 
            </rich:dataTable>  
            <rich:dataScroller for="userProjectRolesAuditsForAdminIdTable" renderIfSinglePage="false"></rich:dataScroller> 
          </h:form>  
          <div class="actionButtons"> 
            <s:button value="Add userProjectRolesAudit" view="/UserProjectRolesAuditEdit.xhtml" disabled="true"> 
              <f:param name="usersId" value="#{usersHome.instance.id}"></f:param>  
              <f:param name="userProjectRolesAuditFrom" value="Users"></f:param> 
            </s:button> 
          </div> 
        </rich:tab>
      </rich:tabPanel> 
    </rich:collapsiblePanel> 
  </ui:define> 
</ui:composition>
